perhaps add a unified interface between hard and softmax for easy abstraction outside this module
